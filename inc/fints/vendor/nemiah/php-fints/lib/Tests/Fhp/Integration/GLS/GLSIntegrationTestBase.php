<?php

namespace Tests\Fhp\Integration\GLS;

use Fhp\Model\SEPAAccount;
use Tests\Fhp\FinTsTestCase;

class GLSIntegrationTestBase extends FinTsTestCase
{
    public const TEST_USERNAME = 'PRIVATE__';
    public const TEST_PIN = 'PRIVATE_____________';
    public const TEST_BANK_CODE = '43060967';
    public const TEST_TAN_MODE = '942';
    public const TEST_KUNDENSYSTEM_ID = 'FAKEKUNDENSYSTE';

    // Anonymous dialog to fetch BPD (HKVVB, then HKEND).
    public const ANONYMOUS_INIT_REQUEST = "HNHBK:1:3+000000000145+300+0+1'HKIDN:2:2+280:43060967+9999999999+0+0'HKVVB:3:3+0+0+0+123456789ABCDEF0123456789+1.0'HKTAN:4:6+4+HKIDN'HNHBS:5:1+1'";
    public const ANONYMOUS_INIT_RESPONSE = "HNHBK:1:3+000000012598+300+FAKEDIALOGIDabc+1+FAKEDIALOGIDabc:1'HIRMG:2:2+3060::Bitte beachten Sie die enthaltenen Warnungen/Hinweise.+0100::Dialog beendet.'HIRMS:3:2:3+3050::BPD nicht mehr aktuell, aktuelle Version enthalten.+0020::Informationen fehlerfrei entgegengenommen.'HIBPA:4:3:3+10+280:43060967+GLS Gemeinschaftsbank eG+1+1+300+500'HIKOM:5:4:3+280:43060967+1+3:https?://hbci-pintan.gad.de/cgi-bin/hbciservlet+2:hbci.gad.de'HISHV:6:3:3+J+RDH:7+PIN:1+RDH:9+RDH:10'HIEKAS:7:5:3+1+1+1+J:J:N:3'HIKAZS:8:4:3+1+1+90:J'HIKAZS:9:5:3+1+1+90:J:N'HIKAZS:10:6:3+1+1+1+90:J:N'HIKAZS:11:7:3+1+1+1+90:J:N'HIPAES:12:1:3+1+1+1'HIPSPS:13:1:3+1+1+1'HIQTGS:14:1:3+1+1+1'HISALS:15:4:3+1+1'HISALS:16:7:3+1+1+1'HICSAS:17:1:3+1+1+1+1:400'HICSBS:18:1:3+1+1+1+N:N'HICSLS:19:1:3+1+1+1+J'HICSES:20:1:3+1+1+1+1:400'HICCSS:21:1:3+1+1+1'HISPAS:22:1:3+1+1+1+J:J:N:sepade?:xsd?:pain.001.001.02.xsd:sepade?:xsd?:pain.001.002.03.xsd:sepade?:xsd?:pain.001.003.03.xsd:sepade?:xsd?:pain.008.002.02.xsd:sepade?:xsd?:pain.008.003.02.xsd:sepade?:xsd?:pain.008.001.02.xsd:sepade?:xsd?:pain.001.001.03.xsd:sepade?:xsd?:pain.001.001.03_GBIC_2.xsd:sepade?:xsd?:pain.008.001.02_GBIC_2.xsd:sepade?:xsd?:pain.001.001.03_GBIC_3.xsd:sepade?:xsd?:pain.008.001.02_GBIC_3.xsd'HICCMS:23:1:3+1+1+1+500:J:N'HIDSES:24:1:3+1+1+1+2:360:2:360'HIBSES:25:1:3+1+1+1+2:360:2:360'HIDMES:26:1:3+1+1+1+2:360:2:360:500:N:N'HIBMES:27:1:3+1+1+1+2:360:2:360:500:N:N'HICDBS:28:1:3+1+1+1+N'HICDLS:29:1:3+1+1+1+0:0:N:J'HIPPDS:30:2:3+1+1+1+1:Telekom:prepaid:N:::15;30;50:2:Vodafone:prepaid:N:::15;25;50:3:E-plus:prepaid:N:::15;20;30:4:O2:prepaid:N:::15;20;30:5:Congstar:prepaid:N:::15;30;50:6:Blau:prepaid:N:::15;20;30'HICDNS:31:1:3+1+1+1+0:1:3650:J:J:J:J:N:J:J:J:J:0102030612:01020304050607080910111213141516171819202122232425262728293099'HIDSBS:32:1:3+1+1+1+N:N:9999'HICUBS:33:1:3+1+1+1+N'HICUMS:34:1:3+1+1+1+OTHR'HICDES:35:1:3+1+1+1+4:1:3650:0102030612:01020304050607080910111213141516171819202122232425262728293099:01:12345'HIDSWS:36:1:3+1+1+1+J'HIDMCS:37:1:3+1+1+1+500:N:N:2:45:2:45::sepade?:xsd?:pain.008.003.02.xsd'HIDSCS:38:1:3+1+1+1+2:45:2:45::sepade?:xsd?:pain.008.003.02.xsd'HIECAS:39:1:3+1+1+1+J:N:N:urn?:iso?:std?:iso?:20022?:tech?:xsd?:camt.053.001.02'GIVPUS:40:1:3+1+1+1+N'GIVPDS:41:1:3+1+1+1+1'HIAUBS:42:6:3+1+1+1+500'HIBBSS:43:1:3+1+1+1+N:N'HIBMBS:44:1:3+1+1+1+N:N'HIDBSS:45:1:3+1+1+1+N:N'HIDMBS:46:1:3+1+1+1+N:N'HICMBS:47:1:3+1+1+1+N:N'HICMES:48:1:3+1+1+1+1:400:500:J:N'HICMLS:49:1:3+1+1+1'HIWDUS:50:5:3+1+1+1+365'HIWPDS:51:6:3+1+1+1+N:N:N'HIBMES:52:2:3+1+1+1+0;1;110000:0;360:500:N:N'HIBSES:53:2:3+1+1+1+0;1;110000:0;360'HIDMES:54:2:3+1+1+1+0;0;1;130000:0;0;360:500:N:N'HIDSES:55:2:3+1+1+1+0;0;1;130000:0;0;360'HIKAUS:56:2:3+1+1+1'HIKIFS:57:7:3+1+1+1+N:N'HICAZS:58:1:3+1+1+1+90:N:N:urn?:iso?:std?:iso?:20022?:tech?:xsd?:camt.052.001.02'HIBAZS:59:1:3+1+1+1+N:N:N'HIZDFS:60:1:3+1+1+1+99'HIDDBS:61:1:3+1+1+1+N:sepade?:xsd?:pain.008.003.02.xsd:sepade?:xsd?:pain.008.001.02.xsd:sepade?:xsd?:pain.008.001.02_GBIC_2.xsd'HIDDES:62:1:3+1+1+1+CORE:3:360:0102030612:01020304050607080910111213141516171819202122232425262728293099:01:12345::sepade?:xsd?:pain.008.003.02.xsd:sepade?:xsd?:pain.008.001.02.xsd:sepade?:xsd?:pain.008.001.02_GBIC_2.xsd'HIDDLS:63:1:3+1+1+1+0:3650:N:J:sepade?:xsd?:pain.008.003.02.xsd:sepade?:xsd?:pain.008.001.02.xsd:sepade?:xsd?:pain.008.001.02_GBIC_2.xsd'HIDDNS:64:1:3+1+1+1+1:3:3650:J:J:J:J:N:J:J:J:N:0102030612:01020304050607080910111213141516171819202122232425262728293099:01:12345::sepade?:xsd?:pain.008.003.02.xsd:sepade?:xsd?:pain.008.001.02.xsd:sepade?:xsd?:pain.008.001.02_GBIC_2.xsd'HIDVKS:65:2:3+1+1+1+N:J'HIKAAS:66:1:3+1+1+1+N:J:J:J:4;PDF;1'HIPOFS:67:1:3+1+1+1+J:N:100;Kundenmitteilung'HIIPSS:68:1:3+1+1+1+36:sepade?:xsd?:pain.001.001.03_GBIC_2.xsd:sepade?:xsd?:pain.001.001.03_GBIC_3.xsd'HIIPZS:69:1:3+1+1+1+:sepade?:xsd?:pain.001.001.03_GBIC_2.xsd:sepade?:xsd?:pain.001.001.03_GBIC_3.xsd'HIBMLS:70:1:3+1+1+1'HIBSAS:71:1:3+1+1+1+2:360:2:360'HIBSLS:72:1:3+1+1+1+J'HIDMLS:73:1:3+1+1+1'HIDSAS:74:1:3+1+1+1+2:360:2:360'HIDSLS:75:1:3+1+1+1+J'HIAUBS:76:9:3+1+1+1+2006:500:15000,'HITANS:77:6:3+1+1+1+J:N:0:942:2:MTAN2:mobileTAN::mobile TAN:6:1:SMS:2048:J:1:N:0:2:N:J:00:0:N:1:944:2:SECUREGO:mobileTAN::SecureGo:6:1:TAN:2048:J:1:N:0:2:N:J:00:0:N:1:962:2:HHD1.4:HHD:1.4:Smart-TAN plus manuell:6:1:Challenge:2048:J:1:N:0:2:N:J:00:0:N:1:972:2:HHD1.4OPT:HHDOPT1:1.4:Smart-TAN plus optisch / USB:6:1:Challenge:2048:J:1:N:0:2:N:J:00:0:N:1:982:2:MS1.0.0:::Smart-TAN photo:6:1:Challenge:2048:J:1:N:0:2:N:J:00:0:N:1'HIPINS:78:1:3+1+1+0+5:20:6:VR-NetKey oder Alias::HKTAN:N:HKKAZ:J:HKSAL:N:HKEKA:N:HKPAE:J:HKPSP:N:HKQTG:N:HKCSA:J:HKCSB:N:HKCSL:J:HKCSE:J:HKCCS:J:HKSPA:N:HKCCM:J:HKDSE:J:HKBSE:J:HKDME:J:HKBME:J:HKCDB:N:HKCDL:J:HKPPD:J:HKCDN:J:HKDSB:N:HKCUB:N:HKCUM:J:HKCDE:J:HKDSW:J:HKDMC:J:HKDSC:J:HKECA:N:HKAUB:J:HKBBS:N:HKBMB:N:HKDBS:N:HKDMB:N:HKCMB:N:HKCME:J:HKCML:J:HKWDU:N:HKWPD:N:HKKAU:N:HKKIF:N:HKCAZ:J:HKBAZ:N:HKZDF:J:HKDDB:N:HKDDE:J:HKDDL:J:HKDDN:J:HKDVK:N:HKKAA:N:HKPOF:N:HKIPS:N:HKIPZ:J:HKBML:J:HKBSA:J:HKBSL:J:HKDML:J:HKDSA:J:HKDSL:J:GKVPU:N:GKVPD:N'HIAZSS:79:1:3+1+1+1+1:N:::::::::::HKCUM;1;0;1;811:HKBSE;1;0;1;811:HKCCS;1;0;1;811:HKQTG;1;0;1;811:HKDSL;1;0;1;811:HKDML;1;0;1;811:HKCCM;1;0;1;811:HKKIF;7;0;1;811:HKCSA;1;0;1;811:HKBAZ;1;0;1;811:HKZDF;1;0;1;811:HKDMC;1;0;1;811:HKIPS;1;0;1;811:HKKAZ;6;0;1;811:HKKAZ;5;0;1;811:HKSAL;4;0;1;811:HKCUB;1;0;1;811:HKWDU;5;0;1;811:HKKAU;2;0;1;811:HKBSL;1;0;1;811:HKAUB;9;0;1;811:HKDDE;1;0;1;811:HKDSC;1;0;1;811:HKCDL;1;0;1;811:HKBMB;1;0;1;811:HKBML;1;0;1;811:HKCSB;1;0;1;811:HKCDN;1;0;1;811:HKDSW;1;0;1;811:HKCAZ;1;0;1;811:HKDSE;1;0;1;811:HKKAA;1;0;1;811:HKAUB;6;0;1;811:HKCDE;1;0;1;811:HKBBS;1;0;1;811:HKBME;2;0;1;811:HKDMB;1;0;1;811:GKVPU;1;0;1;811:HKPPD;2;0;1;811:HKCME;1;0;1;811:HKDSE;2;0;1;811:HKDDL;1;0;1;811:HKDBS;1;0;1;811:HKIPZ;1;0;1;811:HKDME;2;0;1;811:HKDSB;1;0;1;811:HKCML;1;0;1;811:HKDDN;1;0;1;811:HKEKA;5;0;1;811:HKBSE;2;0;1;811:HKBME;1;0;1;811:HKCSE;1;0;1;811:HKSPA;1;0;1;811:GKVPD;1;0;1;811:HKCDB;1;0;1;811:HKDDB;1;0;1;811:HKBSA;1;0;1;811:HKIDN;2;0;1;811:HKECA;1;0;1;811:HKDVK;2;0;1;811:HKDSA;1;0;1;811:HKKAZ;7;0;1;811:HKDME;1;0;1;811:HKPOF;1;0;1;811:HKKAZ;4;0;1;811:HKCSL;1;0;1;811:HKWPD;6;0;1;811:HKSAL;7;0;1;811:HKCMB;1;0;1;811'HIVISS:80:1:3+1+1+1+1;L;;Bankauftrag;;;;1;L;;allgemein;;;;2;L;;Legitimation;;;;2;L;;Benutzerkennung;;;;3;L;;Version;;;;4;L;;Überweisung;;;;5;L;;Umbuchung;;;;6;L;;Umbuchung;;;;6;L;;terminiert;;;;7;L;;Überweisung;;;;7;L;;Referenzkonto;;;;8;L;;Überweisung;;;;8;L;;SEPA/EU;;;;9;L;;Überweisung;;;;9;L;;Inland;;;;10;L;;Überweisung;;;;10;L;;Ausland;;;;11;L;;Sammel-;;;;11;L;;Überweisung;;;;12;L;;Sammelüberw.;;;;12;L;;SEPA;;;;13;L;;Sammelüberw.;;;;13;L;;Ausland;;;;14;L;;Lastschrift;;;;15;L;;Rückgabe;;;;15;L;;Lastschrift;;;;16;L;;Lastschrift;;;;16;L;;SEPA;;;;17;L;;Lastschrift;;;;17;L;;Ausland;;;;18;L;;Sammel-;;;;18;L;;Lastschrift;;;;19;L;;Sammellasts.;;;;19;L;;SEPA;;;;20;L;;Sammellasts.;;;;20;L;;Ausland;;;;21;L;;Termin-;;;;21;L;;Überweisung;;;;22;L;;Terminüberw.;;;;22;L;;SEPA;;;;23;L;;Terminüberw.;;;;23;L;;Ausland;;;;24;L;;Terminüberw.;;;;24;L;;Sammel Inl.;;;;25;L;;Terminüberw.;;;;25;L;;Sammel SEPA;;;;26;L;;Terminüberw.;;;;26;L;;Sammel Ausl.;;;;27;L;;Terminlasts.;;;;27;L;;Inland;;;;28;L;;Terminlasts.;;;;28;L;;SEPA;;;;29;L;;Terminlasts.;;;;29;L;;Ausland;;;;30;L;;Terminlasts.;;;;30;L;;Sammel Inl.;;;;31;L;;Terminlasts.;;;;31;L;;Sammel SEPA;;;;32;L;;Terminlasts.;;;;32;L;;Sammel Ausl.;;;;33;L;;Dauerüberw.;;;;33;L;;Inland;;;;34;L;;Dauer-;;;;34;L;;Überweisung;;;;35;L;;Dauerüberw.;;;;35;L;;Ausland;;;;36;L;;Dauerlasts.;;;;36;L;;Inland;;;;37;L;;Dauerlasts.;;;;37;L;;SEPA;;;;38;L;;Bestand;;;;38;L;;abfragen;;;;39;L;;Löschen;;;;39;L;;Auftrag;;;;40;L;;Aussetzen;;;;40;L;;Auftrag;;;;41;L;;Aussetzen;;;;41;L;;Auftrag;;;;42;L;;Ändern;;;;42;L;;Auftrag;;;;43;L;;Ändern;;;;43;L;;Auftrag;;;;44;L;;Freigabe;;;;44;L;;Überw. DTAUS;;;;45;L;;Freigabe;;;;45;L;;Lasts. DTAUS;;;;46;L;;Freigabe;;;;46;L;;Überw. DTAZV;;;;47;L;;Freigabe;;;;47;L;;Überw. SEPA;;;;48;L;;Freigabe;;;;48;L;;Lasts. SEPA;;;;49;L;;Freigabe;;;;49;L;;DSRZ-Dateien;;;;50;L;;Kontoauszug;;;;50;L;;u. Quittung;;;;51;L;;Kontoauszug;;;;51;L;;an/abmelden;;;;52;L;;Postfach;;;;52;L;;an/abmelden;;;;53;L;;Postkorb;;;;54;L;;Datentresor;;;;55;L;;Wertpapier;;;;55;L;;Kauf;;;;56;L;;Wertpapier;;;;56;L;;Verkauf;;;;57;L;;Wertpapier;;;;57;L;;Geschäft;;;;58;L;;Anlage;;;;58;L;;Abschluss;;;;59;L;;Kredit;;;;59;L;;Abschluss;;;;60;L;;Produkt;;;;60;L;;Kauf;;;;61;L;;Versicherung;;;;61;L;;Abschluss;;;;62;L;;Service;;;;62;L;;Funktionen;;;;63;L;;TAN-Medien;;;;63;L;;Management;;;;64;L;;Mobiltelefon;;;;64;L;;laden;;;;65;L;;GeldKarte;;;;65;L;;laden;;;;66;L;;Zahlung;;;;66;L;;Internet;;;;67;L;;Geldtransfer;;;;67;L;;Internet;;;;68;L;;Freistellung;;;;69;L;;Adresse;;;;69;L;;ändern;;;;70;L;;Wertpapier;;;;70;L;;Kauf;;;;71;L;;Wertpapier;;;;71;L;;Verkauf;;;;72;L;;Wertpapier;;;;72;L;;Geschäft;;;;73;L;;Eigene;;;;73;L;;IBAN;;;;74;L;;IBAN;;;;74;L;;Empfänger;;;;75;L;;IBAN;;;;75;L;;Zahler;;;;76;L;;IBAN;;;;76;L;;Absender;;;;77;L;;Kunden;;;;77;L;;Nummer;;;;78;L;;Vertrags-;;;;78;L;;Kennung;;;;79;L;;Eigene;;;;79;L;;IBAN;;;;80;L;;Name;;;;81;L;;Auftrags-;;;;81;L;;Identifikation;;;;82;L;;Händler;;;;82;L;;Name;;;;83;L;;Karten-;;;;83;L;;nummer;;;;84;L;;TAN;;;;84;L;;Medium;;;;85;L;;Summe nur;;;;85;L;;Vorkommastellen;;;;86;L;;Freistellung;;;;86;L;;ändern;;;;87;L;;Überweisung;;;;87;L;;Instant Payment;;;;88;L;;Adresse?:;;;;88;L;16;#;;;;89;L;;Angebots-Nr?:;;;;89;R;16;#;;;;90;L;;Anzahl?:;;;;90;R;16;#;;;;91;L;;Auftrags-ID?:;;;;91;L;16;#;;;;92;L;;Aut.Merkmal?:;;;;92;L;16;#;;;;93;L;;Bankdaten?:;;;;93;L;16;#;;;;94;L;;Betrag?:;;;;94;R;16;#;;;;95;L;;BIC Empf.?:;;;;95;L;16;#;;;;96;L;;BLZ Abs.?:;;;;96;R;16;#;;;;97;L;;BLZ Empfänger;;;;97;R;16;#;;;;98;L;;BLZ Karte?:;;;;98;R;16;#;;;;99;L;;BLZ Zahler?:;;;;99;R;16;#;;;;100;L;;Eigene BLZ?:;;;;100;R;16;#;;;;101;L;;Eigenes Kto?:;;;;101;R;16;#;;;;102;L;;Geburtsdatum;;;;102;L;16;#;;;;103;L;;Händlername?:;;;;103;L;16;#;;;;104;L;;ISIN?:;;;;104;L;16;#;;;;105;L;;Kartennummer;;;;105;R;16;#;;;;106;L;;Konto Abs.?:;;;;106;R;16;#;;;;107;L;;Konto Empfänger;;;;107;R;16;#;;;;108;L;;Konto Zahler;;;;108;R;16;#;;;;109;L;;Kreditkarte?:;;;;109;R;16;#;;;;110;L;;Limit?:;;;;110;R;16;#;;;;111;L;;Menge?:;;;;111;R;16;#;;;;112;L;;Mobilfunknummer;;;;112;R;16;#;;;;113;L;;Name Empf.?:;;;;113;L;16;#;;;;114;L;;Postleitzahl;;;;114;R;16;#;;;;115;L;;Rate?:;;;;115;R;16;#;;;;116;L;;Referenzkto?:;;;;116;R;16;#;;;;117;L;;Referenzzahl;;;;117;R;16;#;;;;118;L;;Stücke/Nom.?:;;;;118;R;16;#;;;;119;L;;TAN-Medium;;;;119;L;16;#;;;;120;L;;Termin?:;;;;120;L;16;#;;;;121;L;;Vertrag.Kenn;;;;121;L;16;#;;;;122;L;;WP-Kenn-Nr?:;;;;122;R;16;#;;;;123;L;;Kunden-Nr.;;;;123;R;16;#;;;;124;L;;Summe;;;;124;R;16;#;;;;125;L;32;#;;;;126;R;32;#;;;;127;L;16;#;;;;128;R;16;#;;;:HKBME;1;811;18;;;73;;;125;4;IBAN.1;94;4;CtrlSum.1;90;4;NbOfTxs.1:HKBML;1;811;39;;;79;;;125;1;3,1;94;1;7,1;81;;;125;1;2:HKBSA;1;811;42;;;75;;;125;4;IBAN.2;94;4;CtrlSum.1:HKBSE;1;811;14;;;75;;;125;4;IBAN.2;94;4;CtrlSum.1:HKBSL;1;811;39;;;79;;;125;4;IBAN.1;94;4;CtrlSum.1;81;;;125;4;MsgId.1:HKCCM;1;811;11;;;79;;;125;4;IBAN.1;94;4;CtrlSum.1;90;4;NbOfTxs.1:HKCCS;1;811;4;;;74;;;125;4;IBAN.2;94;4;CtrlSum.1:HKCDE;1;811;34;;;74;;;125;4;IBAN.2;94;4;CtrlSum.1:HKCDL;1;811;39;;;73;;;125;4;IBAN.1;94;4;CtrlSum.1:HKCDN;1;811;42;;;74;;;125;4;IBAN.2;94;4;CtrlSum.1:HKCME;1;811;25;;;79;;;125;1;2,1;94;4;CtrlSum.1;90;4;NbOfTxs.1:HKCML;1;811;39;;;79;;;125;1;3,1;94;1;7,1:HKCSA;1;811;42;;;74;;;125;4;IBAN.2;94;4;CtrlSum.1:HKCSE;1;811;21;;;74;;;125;4;IBAN.2;94;4;CtrlSum.1:HKCSL;1;811;39;;;79;;;125;4;IBAN.1;94;4;CtrlSum.1:HKCUM;1;811;5;;;74;;;125;4;IBAN.2;94;4;CtrlSum.1:HKDDE;1;811;37;;;75;;;125;4;IBAN.2;94;4;CtrlSum.1:HKDDL;1;811;39;;;75;;;125;4;IBAN.2;94;4;CtrlSum.1;81;;;125;4;MsgId.1:HKDDN;1;811;42;;;75;;;125;4;IBAN.2;94;4;CtrlSum.1:HKDMC;1;811;18;;;73;;;125;4;IBAN.1;94;4;CtrlSum.1;90;4;NbOfTxs.1:HKDME;1;811;18;;;73;;;125;4;IBAN.1;94;4;CtrlSum.1;90;4;NbOfTxs.1:HKDML;1;811;39;;;79;;;125;1;3,1;94;1;7,1;81;;;125;1;2:HKDSA;1;811;42;;;75;;;125;4;IBAN.2;94;4;CtrlSum.1:HKDSC;1;811;14;;;75;;;125;4;IBAN.2;94;4;CtrlSum.1:HKDSE;1;811;14;;;75;;;125;4;IBAN.2;94;4;CtrlSum.1:HKDSL;1;811;39;;;79;;;125;4;IBAN.1;94;4;CtrlSum.1;81;;;125;4;MsgId.1:HKDSW;1;811;15;;;73;;;125;1;2,1;94;1;4,1:HKPPD;2;811;64;;;79;;;125;1;2,1;94;1;5,1:HKAUB;6;811;10;;;85;;;128;3;Z.3:HKDSE;2;811;14;;;75;;;125;4;IBAN.2;94;4;CtrlSum.1:HKBSE;2;811;14;;;75;;;125;4;IBAN.2;94;4;CtrlSum.1:HKDME;2;811;18;;;73;;;125;4;IBAN.1;94;4;CtrlSum.1;90;4;NbOfTxs.1:HKBME;2;811;18;;;73;;;125;4;IBAN.1;94;4;CtrlSum.1;90;4;NbOfTxs.1:HKAUB;9;811;10;;;85;;;128;3;Z.3:HKZDF;1;811;49;;;79;;;125;1;2,1;81;;;125;1;3;90;1;4,5:HKIPZ;1;811;87;;;74;;;125;4;IBAN.2;94;4;CtrlSum.1:'HITAN:81:6:4+4++noref+nochallenge'HNHBS:82:1+1'";
    public const ANONYMOUS_END_REQUEST = "HNHBK:1:3+000000000083+300+FAKEDIALOGIDabc+2'HKEND:2:1+FAKEDIALOGIDabc'HNHBS:3:1+2'";
    public const ANONYMOUS_END_RESPONSE = "HNHBK:1:3+000000000141+300+FAKEDIALOGIDabc+2+FAKEDIALOGIDabc:2'HIRMG:2:2+0010::Nachricht entgegengenommen.+0100::Dialog beendet.'HNHBS:3:1+2'";

    public const SYNC_REQUEST = "HNHBK:1:3+000000000400+300+0+1'HNVSK:998:3+PIN:1+998+1+1::0+1:20190102:030405+2:2:13:@8@00000000:5:1+280:43060967:PRIVATE__:V:0:0+0'HNVSD:999:1+@238@HNSHK:2:4+PIN:1+999+9999999+1+1+1::0+1+1:20190102:030405+1:999:1+6:10:19+280:43060967:PRIVATE__:S:0:0'HKIDN:3:2+280:43060967+PRIVATE__+0+1'HKVVB:4:3+10+0+0+123456789ABCDEF0123456789+1.0'HKSYN:5:3+0'HNSHA:6:2+9999999++PRIVATE_____________''HNHBS:7:1+1'";

    public const SYNC_RESPONSE = "HNHBK:1:3+000000000589+300+FAKEDIALOGIDabc+1+FAKEDIALOGIDabc:1'HNVSK:998:3+PIN:1+998+1+2::0+1:20200708:130857+2:2:13:@8@00000000:5:1+280:43060967:PRIVATE__:V:0:0+0'HNVSD:999:1+@395@HNSHK:2:4+PIN:1+999+9999999+1+1+2::0+1+1:20200708:130857+1:999:1+6:10:19+280:43060967:PRIVATE__:S:0:0'HIRMG:3:2+3060::Bitte beachten Sie die enthaltenen Warnungen/Hinweise.'HIRMS:4:2:5+0020::Auftrag ausgeführt.'HIRMS:5:2:4+3920::Zugelassene TAN-Verfahren für den Benutzer:942+0901::*PIN gültig.+0020::*Dialoginitialisierung erfolgreich'HISYN:6:4:5+FAKEKUNDENSYSTEMIDabcdefghij'HNSHA:7:2+9999999''HNHBS:8:1+1'";

    public const SYNC_END_REQUEST = "HNHBK:1:3+000000000398+300+FAKEDIALOGIDabc+2'HNVSK:998:3+PIN:1+998+1+1::FAKEKUNDENSYSTEMIDabcdefghij+1:20190102:030405+2:2:13:@8@00000000:5:1+280:43060967:PRIVATE__:V:0:0+0'HNVSD:999:1+@195@HNSHK:2:4+PIN:1+999+9999999+1+1+1::FAKEKUNDENSYSTEMIDabcdefghij+1+1:20190102:030405+1:999:1+6:10:19+280:43060967:PRIVATE__:S:0:0'HKEND:3:1+FAKEDIALOGIDabc'HNSHA:4:2+9999999++PRIVATE_____________''HNHBS:5:1+2'";
    public const SYNC_END_RESPONSE = "HNHBK:1:3+000000000402+300+FAKEKUNDENSYSTE+2+FAKEKUNDENSYSTE:2'HNVSK:998:3+PIN:1+998+1+2::FAKEDIALOGIDabcdefghijklmnop+1+2:2:13:@8@00000000:5:1+280:43060967:PRIVATE__:V:0:0+0'HNVSD:999:1+@197@HNSHK:2:4+PIN:1+999+5357538+1+1+2::FAKEDIALOGIDabcdefghijklmnop+1+1+1:999:1+6:10:19+280:43060967:PRIVATE__:S:0:0'HIRMG:3:2+0010::Nachricht entgegengenommen.+0100::Dialog beendet.'HNSHA:4:2+5357538''HNHBS:5:1+2'";

    // Dialog initialization for main dialog (HKVVB). As this is the first time we use strong authentication, we get the UPD.
    // Also, using strong (=regular) authentication allows us to leave off the HNHBK/HNVSD wrapper here and let FinTsTestCase handle it.
    public const INIT_REQUEST = "HKIDN:3:2+280:43060967+PRIVATE__+FAKEKUNDENSYSTEMIDabcdefghij+1'HKVVB:4:3+10+0+0+123456789ABCDEF0123456789+1.0'HKTAN:5:6+4+HKIDN'";
    public const INIT_RESPONSE = "HIRMG:3:2+3060::Bitte beachten Sie die enthaltenen Warnungen/Hinweise.'HIRMS:4:2:4+3050::UPD nicht mehr aktuell, aktuelle Version enthalten.+3920::Zugelassene TAN-Verfahren für den Benutzer:942+0901::*PIN gültig.+0020::*Dialoginitialisierung erfolgreich'HIRMS:5:2:5+3076::Starke Kundenauthentifizierung nicht notwendig.'HIUPA:6:4:4+PRIVATE__+703+0'" .
        "HIUPD:7:6:4+PRIVATE___::280:43060967+DExxABCDEFGH1234567890+PRIVATE__+1+EUR+PRIVATE__________________++Kontokorrent++HKSAK:1+HKISA:1+HKSSP:1+HKCAZ:1+HKEKA:1+HKKAU:1+HKDDB:1+HKCDB:1+HKPSP:1+HKBML:1+HKBSL:1+HKDML:1+HKCML:1+HKDSL:1+HKCSL:1+HKDDL:1+HKCDL:1+HKPAE:1+HKDVK:1+HKPPD:1+HKBSA:1+HKDSA:1+HKCSA:1+HKDDN:1+HKCDN:1+HKBMB:1+HKBBS:1+HKDMB:1+HKCMB:1+HKDBS:1+HKCSB:1+HKCUB:1+HKKAA:1+HKPOF:1+HKQTG:1+HKSPA:1+HKDSB:1+HKIPZ:1+HKIPS:1+HKCCM:1+HKCUM:1+HKCCS:1+HKDDE:1+HKCDE:1+HKBME:1+HKBSE:1+HKDME:1+HKCME:1+HKDSE:1+HKCSE:1+HKDMC:1+HKDSC:1+HKDSW:1+HKSAL:1+HKKIF:1+HKKAZ:1+HKAUB:1+GKVPU:1+GKVPD:1+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++{\"umsltzt\"?:\"2020-07-08-13.08.57.000642\"}'" .
        "HIUPD:8:6:4+PRIVATE___::280:43060967+DExxABCDEFGH1234567890+PRIVATE__+1+EUR+PRIVATE__________________++Kontokorrent++HKSAK:1+HKISA:1+HKSSP:1+HKCAZ:1+HKEKA:1+HKKAU:1+HKDDB:1+HKCDB:1+HKPSP:1+HKBML:1+HKBSL:1+HKDML:1+HKCML:1+HKDSL:1+HKCSL:1+HKDDL:1+HKCDL:1+HKPAE:1+HKDVK:1+HKPPD:1+HKBSA:1+HKDSA:1+HKCSA:1+HKDDN:1+HKCDN:1+HKBMB:1+HKBBS:1+HKDMB:1+HKCMB:1+HKDBS:1+HKCSB:1+HKCUB:1+HKKAA:1+HKPOF:1+HKQTG:1+HKSPA:1+HKDSB:1+HKIPZ:1+HKIPS:1+HKCCM:1+HKCUM:1+HKCCS:1+HKDDE:1+HKCDE:1+HKBME:1+HKBSE:1+HKDME:1+HKCME:1+HKDSE:1+HKCSE:1+HKDMC:1+HKDSC:1+HKDSW:1+HKSAL:1+HKKIF:1+HKKAZ:1+HKAUB:1+GKVPU:1+GKVPD:1+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++{\"umsltzt\"?:\"2020-07-08-12.02.19.000836\"}'" .
        "HITAN:16:6:5+4++noref+nochallenge'"
    ;

    // Dialog end for main dialog (HKEND).
    public const FINAL_END_REQUEST = "HKEND:3:1+FAKEDIALOGIDabcdefghijklmnopqr'";
    public const FINAL_END_RESPONSE = "HIRMG:3:2+0010::Nachricht entgegengenommen.+0100::Dialog beendet.'";

    /**
     * Executes dialog synchronization and initialization, so that BPD and UPD are filled.
     * @throws \Throwable
     */
    protected function InitAnonymous()
    {
        $this->expectMessage(static::ANONYMOUS_INIT_REQUEST, utf8_decode(static::ANONYMOUS_INIT_RESPONSE));
        $this->expectMessage(static::ANONYMOUS_END_REQUEST, utf8_decode(static::ANONYMOUS_END_RESPONSE));

        $this->fints->getBpd();
    }

    /**
     * Executes dialog synchronization and initialization, so that BPD and UPD are filled.
     * @throws \Throwable
     */
    protected function initDialog()
    {
        // We already know the TAN mode, so it will only fetch the BPD (anonymously) to verify it.
        $this->expectMessage(static::ANONYMOUS_INIT_REQUEST, utf8_decode(static::ANONYMOUS_INIT_RESPONSE));
        $this->expectMessage(static::ANONYMOUS_END_REQUEST, utf8_decode(static::ANONYMOUS_END_RESPONSE));

        // Then when we initialize a dialog, it's going to request a Kundensystem-ID and UPD.
        $this->expectMessage(static::SYNC_REQUEST, utf8_decode(static::SYNC_RESPONSE));
        $this->expectMessage(static::SYNC_END_REQUEST, utf8_decode(static::SYNC_END_RESPONSE));

        // And finally it can initialize the main dialog.
        $this->expectMessage(static::INIT_REQUEST, utf8_decode(static::INIT_RESPONSE));

        $this->fints->selectTanMode(intval(static::TEST_TAN_MODE));
        $login = $this->fints->login();
        $login->ensureDone(); // No TAN required upon login.*/
        $this->assertAllMessagesSeen();
    }

    /**
     * @return SEPAAccount
     */
    protected function getTestAccount()
    {
        $sepaAccount = new SEPAAccount();
        $sepaAccount->setIban('DExxABCDEFGH1234567890');
        $sepaAccount->setBic('GENODEM1GLS');
        $sepaAccount->setAccountNumber('1234567890');
        $sepaAccount->setBlz(self::TEST_BANK_CODE);
        return $sepaAccount;
    }
}
